!function(a){var b=function(b,c,d){d&&(d.stopPropagation(),d.preventDefault()),this.$element=a(b),this.$newElement=null,this.button=null,this.options=a.extend({},a.fn.selectpicker.defaults,this.$element.data(),"object"==typeof c&&c),this.style=this.options.style,this.size=this.options.size,this.init()};b.prototype={constructor:b,init:function(){function b(){var b=k-a(window).scrollTop(),c=window.innerHeight,d=o+parseInt(g.css("margin-top"))+parseInt(g.css("margin-bottom"))+2,e=c-b-m-d;l=e,f.hasClass("dropup")&&(l=b-d),g.css({"max-height":l+"px","overflow-y":"auto","min-height":3*i+"px"})}this.$element.hide();var c=void 0!==this.$element.attr("class")?this.$element.attr("class").split(/\s+/):"",d=this.getTemplate(),e=this.$element.attr("id");d=this.createLi(d),this.$element.after(d),this.$newElement=this.$element.next(".bootstrap-select");var f=this.$newElement,g=this.$newElement.find(".dropdown-menu"),h=g.find("li > a"),i=parseInt(h.css("line-height"))+h.outerHeight(),j=g.find("li .divider").outerHeight(!0),k=this.$newElement.offset().top,l=0,m=this.$newElement.outerHeight();this.button=this.$newElement.find("> button"),void 0!==e&&(this.button.attr("id",e),a('label[for="'+e+'"]').click(function(){f.find("button#"+e).focus()}));for(var n=0;n<c.length;n++)"selectpicker"!=c[n]&&this.$newElement.addClass(c[n]);this.button.addClass(this.style),this.checkDisabled(),this.checkTabIndex(),this.clickListener();var o=parseInt(g.css("padding-top"))+parseInt(g.css("padding-bottom"))+parseInt(g.css("border-top-width"))+parseInt(g.css("border-bottom-width"));if("auto"==this.size)b(),a(window).resize(b),a(window).scroll(b),this.$element.bind("DOMNodeInserted",b);else if(this.size&&"auto"!=this.size&&g.find("li").length>this.size){var p=g.find("li > *").filter(":not(.div-contain)").slice(0,this.size).last().parent().index(),q=g.find("li").slice(0,p+1).find(".div-contain").length;l=i*this.size+q*j+o,g.css({"max-height":l+"px","overflow-y":"scroll"})}this.$element.bind("DOMNodeInserted",a.proxy(this.reloadLi,this))},getTemplate:function(){var a="<div class='btn-group bootstrap-select'><button class='btn dropdown-toggle clearfix' data-toggle='dropdown'><span class='filter-option pull-left'>__SELECTED_OPTION</span>&nbsp;<span class='caret'></span></button><ul class='dropdown-menu' role='menu'>__ADD_LI</ul></div>";return a},reloadLi:function(){var b=[],c=[];if(this.$newElement.find("li").remove(),this.$element.find("option").each(function(){b.push(a(this).text())}),this.$element.find("option").each(function(){var b=void 0!==a(this).attr("class")?a(this).attr("class"):"",d=void 0!==a(this).data("subtext")?'<small class="muted">'+a(this).data("subtext")+"</small>":"",e=void 0!==a(this).parent().data("subtext")?'<small class="muted">'+a(this).parent().data("subtext")+"</small>":"";c.push(a(this).parent().is("optgroup")&&1!=a(this).data("divider")?0==a(this).index()?0!=a(this)[0].index?'<div class="div-contain"><div class="divider"></div></div><dt>'+a(this).parent().attr("label")+e+'</dt><a tabindex="-1" href="#" class="opt '+b+'">'+a(this).text()+d+"</a>":"<dt>"+a(this).parent().attr("label")+e+'</dt><a tabindex="-1" href="#" class="opt '+b+'">'+a(this).text()+d+"</a>":'<a tabindex="-1" href="#" class="opt '+b+'">'+a(this).text()+d+"</a>":1==a(this).data("divider")?'<div class="div-contain"><div class="divider"></div></div>':'<a tabindex="-1" href="#" class="'+b+'">'+a(this).text()+d+"</a>")}),b.length>0)for(var d=0;d<b.length;d++){var e=this.$element.find("option").eq(d).is(":disabled")||this.$element.find("option").eq(d).parent().is(":disabled")?'class="disabled"':"";this.$newElement.find("ul").append("<li rel="+d+" "+e+">"+c[d]+"</li>")}this.$newElement.find("li.disabled a, li dt, li .div-contain").on("click",function(b){b.preventDefault(),b.stopPropagation(),$select=a(this).parent().parents(".bootstrap-select"),$select.find("button").focus()}),this.$newElement.find(".filter-option").html(void 0!=this.$element.find("option:selected").attr("title")?this.$element.find("option:selected").attr("title"):this.$element.find("option:selected").text())},createLi:function(b){var c=[],d=[],e="",f=this.$element[0].selectedIndex?this.$element[0].selectedIndex:0;if(this.$element.find("option").each(function(){c.push(a(this).text())}),this.$element.find("option").each(function(){var b=void 0!==a(this).attr("class")?a(this).attr("class"):"",c=void 0!==a(this).data("subtext")?'<small class="muted">'+a(this).data("subtext")+"</small>":"",e=void 0!==a(this).parent().data("subtext")?'<small class="muted">'+a(this).parent().data("subtext")+"</small>":"";d.push(a(this).parent().is("optgroup")&&1!=a(this).data("divider")?0==a(this).index()?0!=a(this)[0].index?'<div class="div-contain"><div class="divider"></div></div><dt>'+a(this).parent().attr("label")+e+'</dt><a tabindex="-1" href="#" class="opt '+b+'">'+a(this).text()+c+"</a>":"<dt>"+a(this).parent().attr("label")+e+'</dt><a tabindex="-1" href="#" class="opt '+b+'">'+a(this).text()+c+"</a>":'<a tabindex="-1" href="#" class="opt '+b+'">'+a(this).text()+c+"</a>":1==a(this).data("divider")?'<div class="div-contain"><div class="divider"></div></div>':'<a tabindex="-1" href="#" class="'+b+'">'+a(this).text()+c+"</a>")}),c.length>0){b=b.replace("__SELECTED_OPTION",c[f]);for(var g=0;g<c.length;g++){var h=this.$element.find("option").eq(g).is(":disabled")||this.$element.find("option").eq(g).parent().is(":disabled")?'class="disabled"':"";e+="<li rel="+g+" "+h+">"+d[g]+"</li>"}}else b=b.replace("__SELECTED_OPTION","");return this.$element.find("option").eq(f).prop("selected",!0),b=b.replace("__ADD_LI",e)},checkDisabled:function(){this.$element.is(":disabled")&&(this.button.addClass("disabled"),this.button.click(function(a){a.preventDefault()}))},checkTabIndex:function(){if(this.$element.is("[tabindex]")){var a=this.$element.attr("tabindex");this.button.attr("tabindex",a)}},clickListener:function(){a("body").on("touchstart.dropdown",".dropdown-menu",function(a){a.stopPropagation()}),this.$newElement.find("li.disabled a, li dt, li .div-contain").on("click",function(b){b.preventDefault(),b.stopPropagation(),$select=a(this).parent().parents(".bootstrap-select"),$select.find("button").focus()}),this.$newElement.on("click","li a",function(b){b.preventDefault();var c=a(this).parent().index(),d=a(this).parent(),e=d.parents(".bootstrap-select");e.prev("select").not(":disabled")&&(e.prev("select").find("option").removeAttr("selected"),e.prev("select").find("option").eq(c).prop("selected",!0).attr("selected","selected"),e.find(".filter-option").html(d.text()),e.find("button").focus(),e.prev("select").trigger("change"))}),this.$element.on("change",function(){a(this).next(".bootstrap-select").find(".filter-option").html(void 0!=a(this).find("option:selected").attr("title")?a(this).find("option:selected").attr("title"):a(this).find("option:selected").text())})}},a.fn.selectpicker=function(c,d){return this.each(function(){var e=a(this),f=e.data("selectpicker"),g="object"==typeof c&&c;f||e.data("selectpicker",f=new b(this,g,d)),"string"==typeof c&&f[c]()})},a.fn.selectpicker.defaults={style:null,size:"auto"}}(window.jQuery);