nv.models.discreteBar=function(){function a(i){return i.each(function(a){var i=g-f.left-f.right,t=h-f.top-f.bottom,u=d3.select(this);a=a.map(function(a,b){return a.values=a.values.map(function(a){return a.series=b,a}),a});var v=b&&c?[]:a.map(function(a){return a.values.map(function(a,b){return{x:l(a,b),y:m(a,b),y0:a.y0}})});j.domain(b||d3.merge(v).map(function(a){return a.x})).rangeBands([0,i],.1),k.domain(c||d3.extent(d3.merge(v).map(function(a){return a.y}).concat(n))),k.range(p?[t-(k.domain()[0]<0?12:0),k.domain()[1]>0?12:0]:[t,0]),d=d||j,e=e||k.copy().range([k(0),k(0)]);{var w=u.selectAll("g.nv-wrap.nv-discretebar").data([a]),x=w.enter().append("g").attr("class","nvd3 nv-wrap nv-discretebar"),y=x.append("g");w.select("g")}y.append("g").attr("class","nv-groups"),w.attr("transform","translate("+f.left+","+f.top+")");var z=w.select(".nv-groups").selectAll(".nv-group").data(function(a){return a},function(a){return a.key});z.enter().append("g").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),d3.transition(z.exit()).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),z.attr("class",function(a,b){return"nv-group nv-series-"+b}).classed("hover",function(a){return a.hover}),d3.transition(z).style("stroke-opacity",1).style("fill-opacity",.75);var A=z.selectAll("g.nv-bar").data(function(a){return a.values});A.exit().remove();var B=A.enter().append("g").attr("transform",function(a,b){return"translate("+(j(l(a,b))+.05*j.rangeBand())+", "+k(0)+")"}).on("mouseover",function(b,c){d3.select(this).classed("hover",!0),r.elementMouseover({value:m(b,c),point:b,series:a[b.series],pos:[j(l(b,c))+j.rangeBand()*(b.series+.5)/a.length,k(m(b,c))],pointIndex:c,seriesIndex:b.series,e:d3.event})}).on("mouseout",function(b,c){d3.select(this).classed("hover",!1),r.elementMouseout({value:m(b,c),point:b,series:a[b.series],pointIndex:c,seriesIndex:b.series,e:d3.event})}).on("click",function(b,c){r.elementClick({value:m(b,c),point:b,series:a[b.series],pos:[j(l(b,c))+j.rangeBand()*(b.series+.5)/a.length,k(m(b,c))],pointIndex:c,seriesIndex:b.series,e:d3.event}),d3.event.stopPropagation()}).on("dblclick",function(b,c){r.elementDblClick({value:m(b,c),point:b,series:a[b.series],pos:[j(l(b,c))+j.rangeBand()*(b.series+.5)/a.length,k(m(b,c))],pointIndex:c,seriesIndex:b.series,e:d3.event}),d3.event.stopPropagation()});B.append("rect").attr("height",0).attr("width",.9*j.rangeBand()/a.length),p?(B.append("text").attr("text-anchor","middle"),A.select("text").attr("x",.9*j.rangeBand()/2).attr("y",function(a,b){return m(a,b)<0?k(m(a,b))-k(0)+12:-4}).text(function(a,b){return q(m(a,b))})):A.selectAll("text").remove(),A.attr("class",function(a,b){return m(a,b)<0?"nv-bar negative":"nv-bar positive"}).style("fill",function(a,b){return a.color||o(a,b)}).style("stroke",function(a,b){return a.color||o(a,b)}).select("rect").attr("class",s).attr("width",.9*j.rangeBand()/a.length),d3.transition(A).attr("transform",function(a,b){var c=j(l(a,b))+.05*j.rangeBand(),d=m(a,b)<0?k(0):k(0)-k(m(a,b))<1?k(0)-1:k(m(a,b));return"translate("+c+", "+d+")"}).select("rect").attr("height",function(a,b){return Math.max(Math.abs(k(m(a,b))-k(0))||1)}),d=j.copy(),e=k.copy()}),a}var b,c,d,e,f={top:0,right:0,bottom:0,left:0},g=960,h=500,i=Math.floor(1e4*Math.random()),j=d3.scale.ordinal(),k=d3.scale.linear(),l=function(a){return a.x},m=function(a){return a.y},n=[0],o=nv.utils.defaultColor(),p=!1,q=d3.format(",.2f"),r=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout"),s="discreteBar";return a.dispatch=r,a.x=function(b){return arguments.length?(l=b,a):l},a.y=function(b){return arguments.length?(m=b,a):m},a.margin=function(b){return arguments.length?(f.top="undefined"!=typeof b.top?b.top:f.top,f.right="undefined"!=typeof b.right?b.right:f.right,f.bottom="undefined"!=typeof b.bottom?b.bottom:f.bottom,f.left="undefined"!=typeof b.left?b.left:f.left,a):f},a.width=function(b){return arguments.length?(g=b,a):g},a.height=function(b){return arguments.length?(h=b,a):h},a.xScale=function(b){return arguments.length?(j=b,a):j},a.yScale=function(b){return arguments.length?(k=b,a):k},a.xDomain=function(c){return arguments.length?(b=c,a):b},a.yDomain=function(b){return arguments.length?(c=b,a):c},a.forceY=function(b){return arguments.length?(n=b,a):n},a.color=function(b){return arguments.length?(o=nv.utils.getColor(b),a):o},a.id=function(b){return arguments.length?(i=b,a):i},a.showValues=function(b){return arguments.length?(p=b,a):p},a.valueFormat=function(b){return arguments.length?(q=b,a):q},a.rectClass=function(b){return arguments.length?(s=b,a):s},a};