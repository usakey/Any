!function($){var apiParams={colors:1,values:1,backgroundColor:1,scaleColors:1,normalizeFunction:1,enableZoom:1,showTooltip:1,borderColor:1,borderWidth:1,borderOpacity:1,selectedRegions:1,multiSelectRegion:1},apiEvents={onLabelShow:"labelShow",onRegionOver:"regionMouseOver",onRegionOut:"regionMouseOut",onRegionClick:"regionClick",onRegionSelect:"regionSelect",onRegionDeselect:"regionDeselect"};$.fn.vectorMap=function(a){var b={map:"world_en",backgroundColor:"#a5bfdd",color:"#f4f3f0",hoverColor:"#c9dfaf",selectedColor:"#c9dfaf",scaleColors:["#b6d6ff","#005ace"],normalizeFunction:"linear",enableZoom:!0,showTooltip:!0,borderColor:"#818181",borderWidth:1,borderOpacity:.25,selectedRegions:null,multiSelectRegion:!1},c=this.data("mapObject");if("addMap"===a)WorldMap.maps[arguments[1]]=arguments[2];else if("set"===a&&apiParams[arguments[1]])c["set"+arguments[1].charAt(0).toUpperCase()+arguments[1].substr(1)].apply(c,Array.prototype.slice.call(arguments,2));else{if("string"==typeof a&&"function"==typeof c[a])return c[a].apply(c,Array.prototype.slice.call(arguments,1));$.extend(b,a),b.container=this,this.css({position:"relative",overflow:"hidden"}),c=new WorldMap(b),this.data("mapObject",c);for(var d in apiEvents)b[d]&&this.bind(apiEvents[d]+".jqvmap",b[d])}};var VectorCanvas=function(a,b,c){if(this.mode=window.SVGAngle?"svg":"vml",this.params=c,"svg"==this.mode)this.createSvgNode=function(a){return document.createElementNS(this.svgns,a)};else{try{document.namespaces.rvml||document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),this.createVmlNode=function(a){return document.createElement("<rvml:"+a+' class="rvml">')}}catch(d){this.createVmlNode=function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)")}"svg"==this.mode?this.canvas=this.createSvgNode("svg"):(this.canvas=this.createVmlNode("group"),this.canvas.style.position="absolute"),this.setSize(a,b)};VectorCanvas.prototype={svgns:"http://www.w3.org/2000/svg",mode:"svg",width:0,height:0,canvas:null,setSize:function(a,b){if("svg"==this.mode)this.canvas.setAttribute("width",a),this.canvas.setAttribute("height",b);else if(this.canvas.style.width=a+"px",this.canvas.style.height=b+"px",this.canvas.coordsize=a+" "+b,this.canvas.coordorigin="0 0",this.rootGroup){for(var c=this.rootGroup.getElementsByTagName("shape"),d=0,e=c.length;e>d;d++)c[d].coordsize=a+" "+b,c[d].style.width=a+"px",c[d].style.height=b+"px";this.rootGroup.coordsize=a+" "+b,this.rootGroup.style.width=a+"px",this.rootGroup.style.height=b+"px"}this.width=a,this.height=b},createPath:function(a){var b;if("svg"==this.mode)b=this.createSvgNode("path"),b.setAttribute("d",a.path),null!==this.params.borderColor&&b.setAttribute("stroke",this.params.borderColor),this.params.borderWidth>0&&(b.setAttribute("stroke-width",this.params.borderWidth),b.setAttribute("stroke-linecap","round"),b.setAttribute("stroke-linejoin","round")),this.params.borderOpacity>0&&b.setAttribute("stroke-opacity",this.params.borderOpacity),b.setFill=function(a){this.setAttribute("fill",a),null===this.getAttribute("original")&&this.setAttribute("original",a)},b.getFill=function(){return this.getAttribute("fill")},b.getOriginalFill=function(){return this.getAttribute("original")},b.setOpacity=function(a){this.setAttribute("fill-opacity",a)};else{b=this.createVmlNode("shape"),b.coordorigin="0 0",b.coordsize=this.width+" "+this.height,b.style.width=this.width+"px",b.style.height=this.height+"px",b.fillcolor=WorldMap.defaultFillColor,b.stroked=!1,b.path=VectorCanvas.pathSvgToVml(a.path);var c=this.createVmlNode("skew");c.on=!0,c.matrix="0.01,0,0,0.01,0,0",c.offset="0,0",b.appendChild(c);var d=this.createVmlNode("fill");b.appendChild(d),b.setFill=function(a){this.getElementsByTagName("fill")[0].color=a,null===this.getAttribute("original")&&this.setAttribute("original",a)},b.getFill=function(){return this.getElementsByTagName("fill")[0].color},b.getOriginalFill=function(){return this.getAttribute("original")},b.setOpacity=function(a){this.getElementsByTagName("fill")[0].opacity=parseInt(100*a,10)+"%"}}return b},createGroup:function(a){var b;return"svg"==this.mode?b=this.createSvgNode("g"):(b=this.createVmlNode("group"),b.style.width=this.width+"px",b.style.height=this.height+"px",b.style.left="0px",b.style.top="0px",b.coordorigin="0 0",b.coordsize=this.width+" "+this.height),a&&(this.rootGroup=b),b},applyTransformParams:function(a,b,c){"svg"==this.mode?this.rootGroup.setAttribute("transform","scale("+a+") translate("+b+", "+c+")"):(this.rootGroup.coordorigin=this.width-b+","+(this.height-c),this.rootGroup.coordsize=this.width/a+","+this.height/a)}},VectorCanvas.pathSvgToVml=function(a){var b,c,d=0,e=0;return a.replace(/([MmLlHhVvCcSs])((?:-?(?:\d+)?(?:\.\d+)?,?\s?)+)/g,function(a,f,g){g=g.replace(/(\d)-/g,"$1,-").replace(/\s+/g,",").split(","),g[0]||g.shift();for(var h=0,i=g.length;i>h;h++)g[h]=Math.round(100*g[h]);switch(f){case"m":return d+=g[0],e+=g[1],"t"+g.join(",");case"M":return d=g[0],e=g[1],"m"+g.join(",");case"l":return d+=g[0],e+=g[1],"r"+g.join(",");case"L":return d=g[0],e=g[1],"l"+g.join(",");case"h":return d+=g[0],"r"+g[0]+",0";case"H":return d=g[0],"l"+d+","+e;case"v":return e+=g[0],"r0,"+g[0];case"V":return e=g[0],"l"+d+","+e;case"c":return b=d+g[g.length-4],c=e+g[g.length-3],d+=g[g.length-2],e+=g[g.length-1],"v"+g.join(",");case"C":return b=g[g.length-4],c=g[g.length-3],d=g[g.length-2],e=g[g.length-1],"c"+g.join(",");case"s":return g.unshift(e-c),g.unshift(d-b),b=d+g[g.length-4],c=e+g[g.length-3],d+=g[g.length-2],e+=g[g.length-1],"v"+g.join(",");case"S":return g.unshift(e+e-c),g.unshift(d+d-b),b=g[g.length-4],c=g[g.length-3],d=g[g.length-2],e=g[g.length-1],"c"+g.join(",");default:return!1}return""}).replace(/z/g,"")};var WorldMap=function(a){a=a||{};var b=this,c=WorldMap.maps[a.map];this.selectedRegions=[],this.multiSelectRegion=a.multiSelectRegion,this.container=a.container,this.defaultWidth=c.width,this.defaultHeight=c.height,this.color=a.color,this.selectedColor=a.selectedColor,this.hoverColor=a.hoverColor,this.hoverOpacity=a.hoverOpacity,this.setBackgroundColor(a.backgroundColor),this.width=a.container.width(),this.height=a.container.height(),this.resize(),jQuery(window).resize(function(){b.width=a.container.width(),b.height=a.container.height(),b.resize(),b.canvas.setSize(b.width,b.height),b.applyTransform()}),this.canvas=new VectorCanvas(this.width,this.height,a),a.container.append(this.canvas.canvas),this.makeDraggable(),this.rootGroup=this.canvas.createGroup(!0),this.index=WorldMap.mapIndex,this.label=jQuery("<div/>").addClass("jqvmap-label").appendTo(jQuery("body")).hide(),a.enableZoom&&(jQuery("<div/>").addClass("jqvmap-zoomin").text("+").appendTo(a.container),jQuery("<div/>").addClass("jqvmap-zoomout").html("&#x2212;").appendTo(a.container)),b.countries=[];for(var d in c.pathes){var e=this.canvas.createPath({path:c.pathes[d].path});e.setFill(this.color),e.id=b.getCountryId(d),b.countries[d]=e,"svg"==this.canvas.mode?e.setAttribute("class","jvectormap-region"):jQuery(e).addClass("jvectormap-region"),jQuery(this.rootGroup).append(e)}if(jQuery(a.container).delegate("svg"==this.canvas.mode?"path":"shape","mouseover mouseout",function(d){var e=d.target,f=d.target.id.split("_").pop(),g=$.Event("labelShow.jqvmap"),h=$.Event("regionMouseOver.jqvmap");"mouseover"==d.type?(jQuery(a.container).trigger(h,[f,c.pathes[f].name]),h.isDefaultPrevented()||b.highlight(f,e),a.showTooltip&&(b.label.text(c.pathes[f].name),jQuery(a.container).trigger(g,[b.label,f]),g.isDefaultPrevented()||(b.label.show(),b.labelWidth=b.label.width(),b.labelHeight=b.label.height()))):(b.unhighlight(f,e),b.label.hide(),jQuery(a.container).trigger("regionMouseOut.jqvmap",[f,c.pathes[f].name]))}),jQuery(a.container).delegate("svg"==this.canvas.mode?"path":"shape","click",function(d){if(!a.multiSelectRegion)for(var e in c.pathes)b.countries[e].currentFillColor=b.countries[e].getOriginalFill(),b.countries[e].setFill(b.countries[e].getOriginalFill());var f=d.target,g=d.target.id.split("_").pop();jQuery(a.container).trigger("regionClick.jqvmap",[g,c.pathes[g].name]),regionClickEvent.isDefaultPrevented()||(-1!==b.selectedRegions.indexOf(g)?b.deselect(g,f):b.select(g,f))}),a.showTooltip&&a.container.mousemove(function(a){if(b.label.is(":visible")){var c=a.pageX-15-b.labelWidth,d=a.pageY-15-b.labelHeight;0>c&&(c=a.pageX+15),0>d&&(d=a.pageY+15),b.label.css({left:c,top:d})}}),this.setColors(a.colors),this.canvas.canvas.appendChild(this.rootGroup),this.applyTransform(),this.colorScale=new ColorScale(a.scaleColors,a.normalizeFunction,a.valueMin,a.valueMax),a.values&&(this.values=a.values,this.setValues(a.values)),a.selectedRegions)if(a.selectedRegions instanceof Array)for(var f in a.selectedRegions)this.select(a.selectedRegions[f].toLowerCase());else this.select(a.selectedRegions.toLowerCase());this.bindZoomButtons(),a.pins&&(this.pinHandlers=!1,this.placePins(a.pins,a.pinMode)),WorldMap.mapIndex++};WorldMap.prototype={transX:0,transY:0,scale:1,baseTransX:0,baseTransY:0,baseScale:1,width:0,height:0,countries:{},countriesColors:{},countriesData:{},zoomStep:1.4,zoomMaxStep:4,zoomCurStep:1,setColors:function(a,b){if("string"==typeof a)this.countries[a].setFill(b),this.countries[a].setAttribute("original",b);else{var c=a;for(var d in c)this.countries[d]&&(this.countries[d].setFill(c[d]),this.countries[d].setAttribute("original",c[d]))}},setValues:function(a){var b,c=0,d=Number.MAX_VALUE;for(var e in a)b=parseFloat(a[e]),b>c&&(c=a[e]),b&&d>b&&(d=b);this.colorScale.setMin(d),this.colorScale.setMax(c);var f={};for(e in a)b=parseFloat(a[e]),f[e]=b?this.colorScale.getColor(b):this.color;this.setColors(f),this.values=a},setBackgroundColor:function(a){this.container.css("background-color",a)},setScaleColors:function(a){this.colorScale.setColors(a),this.values&&this.setValues(this.values)},setNormalizeFunction:function(a){this.colorScale.setNormalizeFunction(a),this.values&&this.setValues(this.values)},highlight:function(a,b){b=b||$("#"+this.getCountryId(a))[0],this.hoverOpacity?b.setOpacity(this.hoverOpacity):this.hoverColor&&(b.currentFillColor=b.getFill()+"",b.setFill(this.hoverColor))},unhighlight:function(a,b){b=b||$("#"+this.getCountryId(a))[0],b.setOpacity(1),b.currentFillColor&&b.setFill(b.currentFillColor)},select:function(a,b){b=b||$("#"+this.getCountryId(a))[0],this.selectedRegions.indexOf(a)<0&&(this.multiSelectRegion?this.selectedRegions.push(a):this.selectedRegions=[a],$(this.container).trigger("regionSelect.jqvmap",[a]),this.selectedColor&&(b.currentFillColor=this.selectedColor,b.setFill(this.selectedColor)))},deselect:function(a,b){b=b||$("#"+this.getCountryId(a))[0],this.selectedRegions.indexOf(a)>=0&&(this.selectedRegions.splice(this.selectedRegions.indexOf(a),1),$(this.container).trigger("regionDeselect.jqvmap",[a]),b.currentFillColor=b.getOriginalFill(),b.setFill(b.getOriginalFill()))},isSelected:function(a){return this.selectedRegions.indexOf(a)>=0},resize:function(){var a=this.baseScale;this.width/this.height>this.defaultWidth/this.defaultHeight?(this.baseScale=this.height/this.defaultHeight,this.baseTransX=Math.abs(this.width-this.defaultWidth*this.baseScale)/(2*this.baseScale)):(this.baseScale=this.width/this.defaultWidth,this.baseTransY=Math.abs(this.height-this.defaultHeight*this.baseScale)/(2*this.baseScale)),this.scale*=this.baseScale/a,this.transX*=this.baseScale/a,this.transY*=this.baseScale/a},reset:function(){this.countryTitle.reset();for(var a in this.countries)this.countries[a].setFill(WorldMap.defaultColor);this.scale=this.baseScale,this.transX=this.baseTransX,this.transY=this.baseTransY,this.applyTransform()},applyTransform:function(){var a,b,c,d;this.defaultWidth*this.scale<=this.width?(a=(this.width-this.defaultWidth*this.scale)/(2*this.scale),c=(this.width-this.defaultWidth*this.scale)/(2*this.scale)):(a=0,c=(this.width-this.defaultWidth*this.scale)/this.scale),this.defaultHeight*this.scale<=this.height?(b=(this.height-this.defaultHeight*this.scale)/(2*this.scale),d=(this.height-this.defaultHeight*this.scale)/(2*this.scale)):(b=0,d=(this.height-this.defaultHeight*this.scale)/this.scale),this.transY>b?this.transY=b:this.transY<d&&(this.transY=d),this.transX>a?this.transX=a:this.transX<c&&(this.transX=c),this.canvas.applyTransformParams(this.scale,this.transX,this.transY)},makeDraggable:function(){var a,b,c=!1,d=this;d.isMoving=!1,d.isMovingTimeout=!1,this.container.mousemove(function(e){if(c){{d.transX,d.transY}d.transX-=(a-e.pageX)/d.scale,d.transY-=(b-e.pageY)/d.scale,d.applyTransform(),a=e.pageX,b=e.pageY,d.isMoving=!0,d.isMovingTimeout&&clearTimeout(d.isMovingTimeout),d.container.trigger("drag")}return!1}).mousedown(function(d){return c=!0,a=d.pageX,b=d.pageY,!1}).mouseup(function(){return c=!1,d.isMovingTimeout=setTimeout(function(){d.isMoving=!1},100),!1})},bindZoomButtons:function(){var a=this;this.container.find(".jqvmap-zoomin").click(function(){a.zoomIn()}),this.container.find(".jqvmap-zoomout").click(function(){a.zoomOut()})},zoomIn:function(){var a=this,b=(jQuery("#zoom").innerHeight()-12-30-6-7-6)/(this.zoomMaxStep-this.zoomCurStep);if(a.zoomCurStep<a.zoomMaxStep){{a.transX,a.transY,a.scale}a.transX-=(a.width/a.scale-a.width/(a.scale*a.zoomStep))/2,a.transY-=(a.height/a.scale-a.height/(a.scale*a.zoomStep))/2,a.setScale(a.scale*a.zoomStep),a.zoomCurStep++,jQuery("#zoomSlider").css("top",parseInt(jQuery("#zoomSlider").css("top"),10)-b),a.container.trigger("zoomIn")}},zoomOut:function(){var a=this,b=(jQuery("#zoom").innerHeight()-12-30-6-7-6)/(this.zoomMaxStep-this.zoomCurStep);if(a.zoomCurStep>1){{a.transX,a.transY,a.scale}a.transX+=(a.width/(a.scale/a.zoomStep)-a.width/a.scale)/2,a.transY+=(a.height/(a.scale/a.zoomStep)-a.height/a.scale)/2,a.setScale(a.scale/a.zoomStep),a.zoomCurStep--,jQuery("#zoomSlider").css("top",parseInt(jQuery("#zoomSlider").css("top"),10)+b),a.container.trigger("zoomOut")}},setScale:function(a){this.scale=a,this.applyTransform()},getCountryId:function(a){return"jqvmap"+this.index+"_"+a},getPinId:function(a){return this.getCountryId(a)+"_pin"},placePins:function(a,b){var c=this;if((!b||"content"!=b&&"id"!=b)&&(b="content"),"content"==b?jQuery.each(a,function(a,b){if(0!=jQuery("#"+c.getCountryId(a)).length){var d=c.getPinId(a);jQuery("#"+d).length>0&&jQuery("#"+d).remove(),c.container.append('<div id="'+d+'" for="'+a+'" class="jqvmap_pin" style="position:absolute">'+b+"</div>")}}):jQuery.each(a,function(a,b){if(0!=jQuery("#"+c.getCountryId(a)).length){var d=c.getPinId(a);jQuery("#"+d).length>0&&jQuery("#"+d).remove(),c.container.append('<div id="'+d+'" for="'+a+'" class="jqvmap_pin" style="position:absolute"></div>'),jQuery("#"+d).append(jQuery("#"+b))}}),this.positionPins(),!this.pinHandlers){this.pinHandlers=!0;var d=function(){c.positionPins()};this.container.bind("zoomIn",d).bind("zoomOut",d).bind("drag",d)}},positionPins:function(){var a=this,b=this.container.find(".jqvmap_pin");jQuery.each(b,function(b,c){c=jQuery(c);var d=a.getCountryId(c.attr("for")),e=jQuery("#"+d),f=document.getElementById(d).getBBox(),g=e.position(),h=a.scale,i=g.left+f.width/2*h-c.width()/2,j=g.top+f.height/2*h-c.height()/2;c.css("left",i).css("top",j)})},getPin:function(a){var b=jQuery("#"+this.getPinId(a));return b.html()},getPins:function(){var pins=this.container.find(".jqvmap_pin"),ret=new Object;return jQuery.each(pins,function(index,pinObj){pinObj=jQuery(pinObj);var cc=pinObj.attr("for"),pinContent=pinObj.html();eval("ret."+cc+"=pinContent")}),JSON.stringify(ret)},removePin:function(a){jQuery("#"+this.getPinId(a)).remove()},removePins:function(){this.container.find(".jqvmap_pin").remove()}},WorldMap.xlink="http://www.w3.org/1999/xlink",WorldMap.mapIndex=1,WorldMap.maps={};var ColorScale=function(a,b,c,d){a&&this.setColors(a),b&&this.setNormalizeFunction(b),c&&this.setMin(c),c&&this.setMax(d)};ColorScale.prototype={colors:[],setMin:function(a){this.clearMinValue=a,this.minValue="function"==typeof this.normalize?this.normalize(a):a},setMax:function(a){this.clearMaxValue=a,this.maxValue="function"==typeof this.normalize?this.normalize(a):a},setColors:function(a){for(var b=0;b<a.length;b++)a[b]=ColorScale.rgbToArray(a[b]);this.colors=a},setNormalizeFunction:function(a){"polynomial"===a?this.normalize=function(a){return Math.pow(a,.2)}:"linear"===a?delete this.normalize:this.normalize=a,this.setMin(this.clearMinValue),this.setMax(this.clearMaxValue)},getColor:function(a){"function"==typeof this.normalize&&(a=this.normalize(a));for(var b,c=[],d=0,e=0;e<this.colors.length-1;e++)b=this.vectorLength(this.vectorSubtract(this.colors[e+1],this.colors[e])),c.push(b),d+=b;var f=(this.maxValue-this.minValue)/d;for(e=0;e<c.length;e++)c[e]*=f;for(e=0,a-=this.minValue;a-c[e]>=0;)a-=c[e],e++;var g;for(g=e==this.colors.length-1?this.vectorToNum(this.colors[e]).toString(16):this.vectorToNum(this.vectorAdd(this.colors[e],this.vectorMult(this.vectorSubtract(this.colors[e+1],this.colors[e]),a/c[e]))).toString(16);g.length<6;)g="0"+g;return"#"+g},vectorToNum:function(a){for(var b=0,c=0;c<a.length;c++)b+=Math.round(a[c])*Math.pow(256,a.length-c-1);return b},vectorSubtract:function(a,b){for(var c=[],d=0;d<a.length;d++)c[d]=a[d]-b[d];return c},vectorAdd:function(a,b){for(var c=[],d=0;d<a.length;d++)c[d]=a[d]+b[d];return c},vectorMult:function(a,b){for(var c=[],d=0;d<a.length;d++)c[d]=a[d]*b;return c},vectorLength:function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c]*a[c];return Math.sqrt(b)}},ColorScale.arrayToRgb=function(a){for(var b,c="#",d=0;d<a.length;d++)b=a[d].toString(16),c+=1==b.length?"0"+b:b;return c},ColorScale.rgbToArray=function(a){return a=a.substr(1),[parseInt(a.substr(0,2),16),parseInt(a.substr(2,2),16),parseInt(a.substr(4,2),16)]}}(jQuery);