$(function(){$("#external-events").find("div.external-event").each(function(){var a={title:$.trim($(this).text())};$(this).data("eventObject",a),$(this).draggable({zIndex:999,revert:!0,revertDuration:0})});var a=new Date,b=a.getDate(),c=a.getMonth(),d=a.getFullYear(),e=$("#calendar").fullCalendar({header:{left:"prev",center:"title",right:"next"},selectable:!0,selectHelper:!0,select:function(a,b,c){var d=$("#edit-modal"),f=$("#create-event");f.off("click"),f.click(function(){var d=$("#event-name").val();d&&e.fullCalendar("renderEvent",{title:d,start:a,end:b,allDay:c},!0),e.fullCalendar("unselect")}),d.modal("show"),e.fullCalendar("unselect")},editable:!0,droppable:!0,drop:function(a,b){var c=$(this).data("eventObject"),d=$.extend({},c);d.start=a,d.allDay=b,$("#calendar").fullCalendar("renderEvent",d,!0),$(this).remove()},events:[{title:"All Day Event",start:new Date(d,c,1)},{title:"Long Event",start:new Date(d,c,b+5),end:new Date(d,c,b+7)},{id:999,title:"Repeating Event",start:new Date(d,c,b-3,16,0),allDay:!1},{id:999,title:"Repeating Event",start:new Date(d,c,b+4,16,0),allDay:!1},{title:"Meeting",start:new Date(d,c,b,10,30),allDay:!1},{title:"Lunch",start:new Date(d,c,b,12,0),end:new Date(d,c,b,14,0),allDay:!1},{title:"Birthday Party",start:new Date(d,c,b+1,19,0),end:new Date(d,c,b+1,22,30),allDay:!1},{title:"Click for Okendoken",start:new Date(d,c,28),end:new Date(d,c,29),url:"http://okendoken.com/"}],eventClick:function(a){if(a.url)return window.open(a.url,"gcalevent","width=700,height=600"),!1;var b=$("#myModal"),c=$("#myModalLabel");c.html(a.title),b.find(".modal-body p").html(function(){return a.allDay?"All day event":"Start At: <strong>"+a.start.getHours()+":"+(0==a.start.getMinutes()?"00":a.start.getMinutes())+"</strong></br>"+(null==a.end?"":"End At: <strong>"+a.end.getHours()+":"+(0==a.end.getMinutes()?"00":a.end.getMinutes())+"</strong>")}()),b.modal("show")}});$("#calendar-switcher").find("label").click(function(){e.fullCalendar("changeView",$(this).find("input").val())}),$("#today").click(function(){e.fullCalendar("today")})});